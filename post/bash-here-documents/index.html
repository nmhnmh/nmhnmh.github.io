<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml" />
<!-- Facebook OG Tags-->
<meta property="og:type" content="website">
<meta property="og:url" content="http://niminghao.com/post/bash-here-documents">
<meta property="og:title" content="Bash Here Documents">
<meta property="og:description" content="">
<meta property="og:site_name" content="明浩的个人网站">
<meta property="og:locale" content="en_US">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@niminghao">
<meta name="twitter:creator" content="@niminghao">
<meta name="twitter:url" content="http://niminghao.com/post/bash-here-documents">
<meta name="twitter:title" content="Bash Here Documents">
<meta name="twitter:description" content="">

<title>Post: Bash Here Documents</title>
    <link rel="stylesheet" href="/assets/css/normalize.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/highlight.js/9.11.0/styles/monokai-sublime.min.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/desktop.css">
    <link rel="stylesheet" href="/assets/css/mobile.css">
  </head>
  <body>
    <header>
      <a href="/" id="logo">明浩的个人网站</a>
      <div id="nav_trigger">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <ul id="nav_menu">
        <li><a href="/posts">写 / Posts</a></li>
        <li><a href="/books">读 / Reading</a></li>
        <li><a href="/projects">做 / Projects</a></li>
        <li><a href="/references">杂 / References</a></li>
        <li><a href="/about">我 / About</a></li>
        <li><input type="text" id="q" placeholder="搜 / Search"></li>
      </ul>
      <div id="q_results">
      </div>
    </header>
    <div class="wrapper">
  <div class="" id="entry_header">
    <span class="entry_title">Bash Here Documents</span>
    <div class="entry_info">
      Nov 14, 2016
    </div>
  </div>

  <div class="content_wrapper">
    <h1>What Is Here Document?</h1>
<p>Here Document enables you to "embed" some text chunks inside your scripts, without needing to worry about escaping, line breaks, concatenations etc. It is especially useful when you want to keep some configuration file chunks inside your script file or when you want to write a multiple line text chunk on command line.</p>
<p>Here Doc used on command line:</p>
<pre><code class="bash">cat &lt;&lt;END
some text
another new line with variable ${PATH}
the third line 
END
</code></pre>

<p>Here Doc used inside script file, write Apache configuration file chunks:</p>
<pre><code class="bash">#!/usr/bin/env bash

cat &gt; site.conf &lt;&lt; 'END'
&lt;VirtualHost *:80&gt;
    ServerAdmin admin@test.com
    ServerName test.com
    ServerAlias www.test.com
    DocumentRoot /var/www/test.com/public_html
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;
END

</code></pre>

<p>But you must understand how does it work behind the scene, though it looks like a long paragraph of text, <strong>Here Doc is passed as a temporary file/stream literal, not a string literal</strong>, so when using Here Doc, choose tools and utilities that works with files or streams(like <code>cat</code>, <code>wc</code>, <code>less</code>), those who expecting string(like <code>echo</code>) will not work!</p>
<p>An error seen many times: use echo with Here Doc</p>
<pre><code class="bash"># Works, cat works with files
cat &lt;&lt;EOL
cat works with file
so it is find
EOL

# Will not work, echo want a string
echo &lt;&lt;EOL
echo want a string
so it will not work
EOL

</code></pre>

<p>By default, Here Doc support variable interpolation, if you don't want this, add single quote to the opening Mark, Here Doc without variable interpolation is also called <strong>Now Document</strong>.</p>
<pre><code class="bash"># Will expand $PATH variable
cat &lt;&lt;EOL
You Path is:
    ${PATH}
EOL

# Will not expand $PATH variable
cat &lt;&lt;'EOL'
You Path is:
    ${PATH}
EOL
</code></pre>

<h1>What Is Here String?</h1>
<p>Here String is something similar(still a stream/file literal, not string literal), but with simpler and different syntax:</p>
<pre><code class="bash">read a b c &lt;&lt;&lt; &quot;A B C&quot;
echo $a $b $c
</code></pre>

<pre><code class="bash">echo &quot;A B C&quot; | read a b c
echo $a $b $c
</code></pre>

<p>The first code snippet will print the contents as expected, a very good example of how here string could be useful.
The second code snippet will print a blank line, actually the contents are read into <code>$a</code> <code>$b</code> <code>$c</code>, but the <code>read</code> builtin is after a <code>|</code> operator, so it is in a sub-process, when we come back and try to print, those values are already gone with the sub-process.</p>
<p>Compared with here document, the obvious difference is the lackinig of delimiters in here strings.</p>
<h1>Here Document In Other Languages</h1>
<p>Languages like PHP, Perl support Here Doc and Now Doc that is kinda compatible with Bash.</p>
<p>Languages like C++ has raw string literals which serves similar purpose:</p>
<pre><code class="cpp">const char *p = R&quot;(
a
b
c
)&quot;;
</code></pre>

<p>Languages like Javascript also has string template:</p>
<pre><code class="js">var name = 'jack';
console.log(`
    Hi, my name is: ${name}!
    Nice to meet you!
`)
</code></pre>
    <br>
    <strong>Tags: </strong>
      <a href="/tags#Bash" class="entry_tag"> Bash </a>
      <a href="/tags#Command Line" class="entry_tag"> Command Line </a>
  </div>
    </div>
    <footer>
        <form style="padding:3px;text-align:center;margin:10px auto;" action="https://tinyletter.com/nmhnmh" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/nmhnmh', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true"><p><label for="tlemail">Subscribe to my personal newsletter</lable></p></p><label for="tlemail">订阅我的个人邮件列表</label></p><p><input type="email" style="border:1px solid #eee; min-width:140px; padding: 5px 10px;" name="email" id="tlemail" placeholder="your email here"/></p><input type="hidden" value="1" name="embed"/><input type="submit" value="Subscribe/订阅" /><p><a href="https://tinyletter.com" target="_blank">powered by TinyLetter</a></p></form>

        <div>
          <a href="https://twitter.com/niminghao" title="Visit My Twitter"><img style="width: 31px; height: 31px;" src="/assets/images/twitter.png" alt="Twitter"></a>
          <a href="#niminghao804.gmail" title="Send me an email: niminghao804.gmail"><img style="width: 31px; height: 31px;" src="/assets/images/gmail.png" alt="Gmail"></a>
          <a href="https://github.com/nmhnmh" title="See me on Github"><img style="width: 31px; height: 31px;" src="/assets/images/github.png" alt="Github"></a>
          <a href="https://www.linkedin.com/in/nmhnmh/" title="Connect with me on Linkedin"><img style="height: 31px;" src="/assets/images/linkedin.png" alt="Linkedin"></a>
          <a href="/rss.xml" title="Subscribe to RSS Feed"><img style="width: 31px; height: 31px;" src="/assets/images/rss.jpg" alt="RSS"></a>
          <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International"><img style="height: 31px;" src="/assets/images/cc-by-nc-sa.png" alt="CC BY-NC-SA 4.0"></a>
        </div>
        <div style="font-size: 0.6rem">
          If not explicitly specified, contents on this website are licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
          <br>
          未单独声明的情况下，本站内容默认采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
        </div>
    </footer>
    <script src='https://cdn.jsdelivr.net/highlight.js/9.11.0/highlight.min.js'></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src='https://cdn.jsdelivr.net/jquery/3.2.1/jquery.min.js'></script>
    <script src='https://cdn.jsdelivr.net/lunr/1.0.0/lunr.min.js'></script>
    <script>
    function initSearch(){
      var index = window.site_index = lunr(function () {
        this.field('title', {boost: 10})
        this.field('tags')
        this.ref('link');
      })
      var store = window.site_index_store = {};
      $.getJSON('/index.json', function(data){
        var len = data.length;
        for(var i=0;i<len;i++){
          index.add(data[i]);
          store[data[i].link] = data[i];
        }
      })
    }
    function display_result(data){
      var panel = $('#q_results');
      var len = data.length;
      if(len>0){
        panel.show();
        var html = "<ul>";
        for(var i=0;i<len && i<20;i++){
          var item = window.site_index_store[data[i].ref];
          html += "<li><a href='"+item.link+"'>"+item.title+"</a></li>"
        }
        html += "</ul>";
        panel.html(html)
      } else {
        panel.hide();
      }
    }
    var search_timer = null;
    $('#q').on('focus', function(e){
      if(!window.site_index)
        initSearch();
    });
    $('#q').on('keyup', function(e){
      var v = $('#q').val().trim();
      // debounce
      clearTimeout(search_timer);
      // clear result when no query provided
      if(!v){
        display_result([]);
        return;
      }
      search_timer = setTimeout(function(query){
        display_result(window.site_index.search(v));
      }, 300, v);
    });
    </script>
    <script>
    document.getElementById('nav_trigger').addEventListener('click', function(e){
      var menu = document.getElementById('nav_menu');
      var styles = window.getComputedStyle(menu, null);
      if(styles.getPropertyValue('display')==='none'){
        menu.style.display = 'block';
      } else {
        menu.style.display = 'none';
      }
    });
    </script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-89643442-1', 'auto');
    ga('send', 'pageview');
    </script>
  </body>
</html>
